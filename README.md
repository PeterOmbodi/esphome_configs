# ESPHome Configuration: Battery, Weather, Solar Forecast, and Power Meters

This repository contains a production-ready ESPHome configuration for an ESP32-based 320×240 LVGL touchscreen (CYD - cheap yellow display). 
It displays live data from a JK BMS, weather information from OpenWeatherMap, solar irradiance forecast from Solcast, and real-time energy flow metrics for solar and grid usage.

---

## 🔋 Battery Monitoring (JK BMS)

- **Battery SOC** displayed as percentage with icon and bar
- **Battery Power** (charge/discharge) shown with dynamic color bar
  - Blue = charging
  - Yellow = mild discharge
  - Red = heavy discharge
- Icons are Unicode characters rendered from Material Design Icons (MDI)

---

## 🌤 Weather (OpenWeatherMap)

- **Temperature** with °C and weather icon
- **Humidity** with % and water drop icon
- **Weather condition** (e.g. "Sunny", "Cloudy") in Ukrainian
- Icons are matched by condition string using `text_sensor` and `lambda`

---

## ☀️ PV Forecast (Solcast)

- Displays **forecasted solar irradiance** from Solcast via Home Assistant sensor
- Icon rendered as sun with rays
- Useful for estimating solar availability for off-grid or hybrid setups

---

## ⚡ Power Meters

- **Solar PV Generation** — `sensor.solar2mqtt_pv_charging_power`
  - Shows how much power is currently being generated by your solar panels
- **Grid Power Consumption** — `sensor.xoca_dac2121c_bi_phase_a_power`
  - Displays how much energy is being drawn from the public grid
- **Household Power Load** — `sensor.solar2mqtt_ac_out_watt`
  - Shows how much energy your household is consuming in real time

These values are visualized via bars and labels, using dynamic coloring and clear units (`W`, `%`, etc.).

---

## 🖥 User Interface (LVGL)

- UI layout uses `obj:` and `layout: GRID` for consistent structure
- All labels, bars, and images use proper alignment and spacing
- Fonts:
  - Roboto Condensed for text
  - FontAwesome or MDI for icons
- Cyrillic characters supported (Ukrainian)

---

## 📁 File Structure

```
.
├── esphome-web-7692c0.yaml         # Main configuration file
├── secrets.yaml                    # WiFi, MQTT and other credentials (not included)
├── images/                         # Optional: image assets for icons (if used)
└── fonts/                          # Font files used in display
```
## 📷 Screenshots

![image](https://github.com/user-attachments/assets/1be807e0-f227-4d53-8365-b4ca3f431394)

---

## 🧩 Requirements

- **ESP32** (with enough PSRAM, e.g. WROVER recommended)
- 320×240 TFT or IPS touch display 
- Home Assistant with:
  - `sensor.jk_bms_*` for BMS
  - `sensor.openweathermap_*` for weather
  - `sensor.solcast_pv_forecast_*` for solar forecast
  - `sensor.solar2mqtt_*` and `sensor.xoca_*` for power meters
- Fonts with support for required Unicode glyphs

---

## 🚀 Setup Instructions

1. Copy the contents of esphome-web-7692c0.yaml into your own ESPHome configuration file. Copy required fonts into your ESPHome fonts/ folder.
2. Add or update your `secrets.yaml` as needed.
3. Make sure all referenced sensors exist in Home Assistant.
4. Open ESPHome and compile/upload the configuration.
5. Enjoy your informative, real-time solar and battery dashboard!

---

## 🛠 To Do / Ideas

- Add gesture navigation between multiple screens
- Expand to show historical graphs or max PV forecast for today

---

## 📄 License

MIT License — free to use, modify, and contribute.
